{% extends "blog/base.html" %}
{% load static %}
{% load comments %}
{% block css %}
    <link rel="stylesheet" href="{% static 'blog/css/emacs.css' %}">
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h1>{{ entry.title }}</h1>
                <p>
                    <strong>{{ entry.author }}</strong>
                    &nbsp;&nbsp;&nbsp;&nbsp;{{ entry.created_time | date:'Y年m月d日' }}
                    &nbsp;&nbsp;&nbsp;&nbsp;分类
                    {% for category in entry.category.all %}
                        &nbsp;&nbsp;
                        <a href="{% url 'blog:blog_category' category_id=category.id %}">{{ category.name }}</a>
                    {% endfor %}
                    &nbsp;&nbsp;&nbsp;&nbsp;标签
                    {% for tag in entry.tags.all %}
                        &nbsp;&nbsp;<a href="{% url 'blog:blog_tag' tag_id=tag.id %}">{{ tag.name }}</a>
                    {% endfor %}
                    &nbsp;&nbsp;&nbsp;&nbsp;浏览量：
                    &nbsp;&nbsp;{{ entry.visiting }}
                    {% if entry.img %}
                        <img src="{{ entry.img.url }}" width="60%" height="270px"/>
                    {% endif %}
                <hr>
                <p>
                    {{ entry.toc|safe }}

                    {{ entry.body|safe }}
                </p>
                </p>
                <hr>
                <div class="row">
                    <hr/>
                    {% get_comment_form for entry as form %}
                    {% get_comment_count for entry as comment_count %}
                    <h3>评论总数： {{ comment_count }}</h3>
                    <hr/>
                </div>
                <div class="row">

                    <form class="form-horizontal" action="{% comment_form_target %}" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="input_comment" class="pull-left control-label">评论内容:</label>
                            <div class="col-sm-10">
                    <textarea style="resize:none;" class="form-control" rows=6 name="comment" id="input_comment"
                              placeholder="在此输入评论" required></textarea>
                            </div>
                        </div>
                        <span style="display: none;">{{ form.honeypot }}</span>
                        {{ form.content_type }}
                        {{ form.object_pk }}
                        {{ form.timestamp }}
                        {{ form.security_hash }}
                        <input type="hidden" name="next" value="{% url 'blog:blog_detail' entry.id %}"/>
                        <input name="parent_id" type="hidden" value="-1"/>
                        <input name="level" type="hidden" value="0"/>

                        <div class="form-group col-sm-11">
                            <div class="pull-left" style="margin-left: 68px;">
                                <button type="reset" class="btn btn-default"><span
                                        class="glyphicon glyphicon-repeat"></span>&nbsp;&nbsp;重置
                                </button>
                            </div>
                            <div class="pull-right" style="margin-right: 12px;">
                                <button type="submit" class="btn btn-success" id="id_submit"><span
                                        class="glyphicon glyphicon-send"></span>&nbsp;&nbsp;评论
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="col-md-3">
                {% block toc %}
                    <div class="row">
                        <div class="widget">
                            <h3>博客目录</h3>
                            {{ entry.toc|safe }}
                        </div>
                    </div>
                {% endblock %}
                {% include 'blog/right_sitebar.html' %}

            </div>
        </div>
    </div>



{% endblock content %}
